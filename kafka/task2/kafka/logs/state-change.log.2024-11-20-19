[2024-11-20 18:19:38,489] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-11-20 18:19:52,057] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-11-20 18:19:52,058] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(2) for 0 partitions (state.change.logger)
[2024-11-20 18:20:00,654] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(1, 2) for 0 partitions (state.change.logger)
[2024-11-20 18:20:00,655] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(3) for 0 partitions (state.change.logger)
[2024-11-20 18:20:42,560] INFO [Controller id=1 epoch=1] Changed partition test-topic-0 state from NonExistentPartition to NewPartition with assigned replicas 3,1 (state.change.logger)
[2024-11-20 18:20:42,561] INFO [Controller id=1 epoch=1] Changed partition test-topic-1 state from NonExistentPartition to NewPartition with assigned replicas 1,2 (state.change.logger)
[2024-11-20 18:20:42,561] INFO [Controller id=1 epoch=1] Changed partition test-topic-2 state from NonExistentPartition to NewPartition with assigned replicas 2,3 (state.change.logger)
[2024-11-20 18:20:42,561] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-11-20 18:20:42,569] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-11-20 18:20:42,668] INFO [Controller id=1 epoch=1] Changed partition test-topic-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=0, isrWithBrokerEpoch=List(BrokerState(brokerId=3, brokerEpoch=-1), BrokerState(brokerId=1, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2024-11-20 18:20:42,668] INFO [Controller id=1 epoch=1] Changed partition test-topic-1 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isrWithBrokerEpoch=List(BrokerState(brokerId=1, brokerEpoch=-1), BrokerState(brokerId=2, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2024-11-20 18:20:42,668] INFO [Controller id=1 epoch=1] Changed partition test-topic-2 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isrWithBrokerEpoch=List(BrokerState(brokerId=2, brokerEpoch=-1), BrokerState(brokerId=3, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=0) (state.change.logger)
[2024-11-20 18:20:42,675] INFO [Controller id=1 epoch=1] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 1 become-follower partitions (state.change.logger)
[2024-11-20 18:20:42,680] INFO [Controller id=1 epoch=1] Sending LeaderAndIsr request to broker 2 with 1 become-leader and 1 become-follower partitions (state.change.logger)
[2024-11-20 18:20:42,681] INFO [Controller id=1 epoch=1] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 1 become-follower partitions (state.change.logger)
[2024-11-20 18:20:42,681] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(1, 2, 3) for 3 partitions (state.change.logger)
[2024-11-20 18:20:42,682] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-11-20 18:20:42,688] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 3 from controller 1 for 2 partitions (state.change.logger)
[2024-11-20 18:20:42,690] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 1 from controller 1 for 2 partitions (state.change.logger)
[2024-11-20 18:20:42,690] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 2 from controller 1 for 2 partitions (state.change.logger)
[2024-11-20 18:20:42,716] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 1 epoch 1 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-11-20 18:20:42,730] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 1 epoch 1 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-11-20 18:20:42,730] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 2 from controller 1 epoch 1 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-11-20 18:20:42,833] INFO [Broker id=1] Leader test-topic-1 with topic id Some(wl9kg_u7TeqrIOmPNDnSBQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [1,2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2024-11-20 18:20:42,850] INFO [Broker id=2] Leader test-topic-2 with topic id Some(wl9kg_u7TeqrIOmPNDnSBQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2,3], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2024-11-20 18:20:42,866] INFO [Broker id=3] Leader test-topic-0 with topic id Some(wl9kg_u7TeqrIOmPNDnSBQ) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [3,1], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2024-11-20 18:20:43,019] INFO [Broker id=1] Follower test-topic-0 starts at leader epoch 0 from offset 0 with partition epoch 0 and high watermark 0. Current leader is 3. Previous leader Some(3) and previous leader epoch was 0. (state.change.logger)
[2024-11-20 18:20:43,021] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 1 epoch 1 with correlation id 3 for 1 partitions (state.change.logger)
[2024-11-20 18:20:43,049] INFO [Broker id=3] Follower test-topic-2 starts at leader epoch 0 from offset 0 with partition epoch 0 and high watermark 0. Current leader is 2. Previous leader Some(2) and previous leader epoch was 0. (state.change.logger)
[2024-11-20 18:20:43,050] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 1 epoch 1 with correlation id 1 for 1 partitions (state.change.logger)
[2024-11-20 18:20:43,054] INFO [Broker id=2] Follower test-topic-1 starts at leader epoch 0 from offset 0 with partition epoch 0 and high watermark 0. Current leader is 1. Previous leader Some(1) and previous leader epoch was 0. (state.change.logger)
[2024-11-20 18:20:43,056] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 1 epoch 1 with correlation id 2 for 1 partitions (state.change.logger)
[2024-11-20 18:20:43,088] INFO [Broker id=1] Finished LeaderAndIsr request in 401ms correlationId 3 from controller 1 for 2 partitions (state.change.logger)
[2024-11-20 18:20:43,114] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 1 with correlation id 4 (state.change.logger)
[2024-11-20 18:20:43,125] INFO [Broker id=3] Finished LeaderAndIsr request in 435ms correlationId 1 from controller 1 for 2 partitions (state.change.logger)
[2024-11-20 18:20:43,141] INFO [Broker id=2] Finished LeaderAndIsr request in 453ms correlationId 2 from controller 1 for 2 partitions (state.change.logger)
[2024-11-20 18:20:43,145] INFO [Broker id=3] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 1 with correlation id 2 (state.change.logger)
[2024-11-20 18:20:43,166] INFO [Broker id=2] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 1 with correlation id 3 (state.change.logger)
[2024-11-20 18:30:34,457] INFO [Controller id=1 epoch=1] Changed partition test-topic-1 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=1, isrWithBrokerEpoch=List(BrokerState(brokerId=2, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=1) (state.change.logger)
[2024-11-20 18:30:34,457] INFO [Controller id=1 epoch=1] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2024-11-20 18:30:34,458] INFO [Controller id=1 epoch=1] Sending LeaderAndIsr request to broker 2 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2024-11-20 18:30:34,459] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(1, 2, 3) for 1 partitions (state.change.logger)
[2024-11-20 18:30:34,467] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-11-20 18:30:34,469] INFO [Controller id=1 epoch=1] Sending StopReplica request for 1 replicas to broker 1 (state.change.logger)
[2024-11-20 18:30:34,502] INFO [Controller id=1 epoch=1] Partition test-topic-0 state changed to (Leader:3,ISR:3,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:1) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-11-20 18:30:34,504] INFO [Controller id=1 epoch=1] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2024-11-20 18:30:34,505] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(1, 2, 3) for 1 partitions (state.change.logger)
[2024-11-20 18:30:34,505] INFO [Controller id=1 epoch=1] Sending StopReplica request for 1 replicas to broker 1 (state.change.logger)
[2024-11-20 18:31:02,476] INFO [Controller id=1 epoch=2] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-11-20 18:31:02,529] INFO [Controller id=1 epoch=2] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2024-11-20 18:31:02,533] INFO [Controller id=1 epoch=2] Sending UpdateMetadata request to brokers HashSet(1) for 2 partitions (state.change.logger)
